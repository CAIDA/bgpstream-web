<div class="row">
  <div class="col-md-3 col-md-push-9" id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>Both BGP Stream and this documentation are still under active development and features will likely change between versions. </dd>
<dd>
Please contact <a href="#" onclick="location.href='mai'+'lto:'+'bgp'+'st'+'rea'+'m-'+'inf'+'o@'+'cai'+'da'+'.or'+'g'; return false;">bgpst<span style="display: none;">.nosp@m.</span>ream<span style="display: none;">.nosp@m.</span>-info<span style="display: none;">.nosp@m.</span>@cai<span style="display: none;">.nosp@m.</span>da.or<span style="display: none;">.nosp@m.</span>g</a> with any questions and/or suggestions.</dd></dl>
<h1><a class="anchor" id="download"></a>
Download            </h1>
<p>bgpstream 1.0.0 can be downloaded <a href="http://www.caida.org/~chiara/bgpstream-doc/bgpstream-1.0.0.tar.gz">here</a>.</p>
<h1><a class="anchor" id="qstart"></a>
Quick Start               </h1>
<p>In order to install bgpstream you need to follow the list of instructions below:</p>
<pre class="fragment">$ ./configure
$ make
$ make check
$ (sudo) make install
</pre><p>Use the &ndash;prefix option to install bgpstream and bgpreader in a local directory.</p>
<p>The procedure above builds and installs:</p><ul>
<li>the <em>bgpstream</em> library</li>
<li>the <em>bgpreader</em> tool</li>
</ul>
<p>If you are interested in installing the python bindings, then continue the installation following the instructions <a href="http://www.caida.org/~chiara/bgpstream-doc/pybgpstream/install.html">here</a>.</p>
<p>The distribution contains a python tool for the rapid creation/population of an sqlite database. The script is located in the <em>tools</em> folder, for more information run: </p><pre class="fragment">python tools/bgpstream_sqlite_mgmt.py -h
</pre><h1><a class="anchor" id="dependencies"></a>
Dependencies        </h1>
<p>BGP Stream is written in C and should compile with any ANSI compliant C Compiler which supports the C99 standard. Please email <a href="#" onclick="location.href='mai'+'lto:'+'bgp'+'st'+'rea'+'m-'+'inf'+'o@'+'cai'+'da'+'.or'+'g'; return false;">bgpst<span style="display: none;">.nosp@m.</span>ream<span style="display: none;">.nosp@m.</span>-info<span style="display: none;">.nosp@m.</span>@cai<span style="display: none;">.nosp@m.</span>da.or<span style="display: none;">.nosp@m.</span>g</a> with any issues.</p>
<p>Building BGP Stream requires:</p><ul>
<li><a href="http://research.wand.net.nz/software/libtrace.php">libtrace</a> version 3.0.14 or higher<ul>
<li>a working version of libtrace is available at <a href="http://research.wand.net.nz/software/libtrace/libtrace-3.0.22.tar.bz2">http://research.wand.net.nz/software/libtrace/libtrace-3.0.22.tar.bz2</a></li>
</ul>
</li>
<li><a href="https://www.sqlite.org/">sqlite3</a> c library<ul>
<li>a working version of sqlite3 is available at <a href="https://www.sqlite.org/2015/sqlite-autoconf-3081002.tar.gz">https://www.sqlite.org/2015/sqlite-autoconf-3081002.tar.gz</a></li>
</ul>
</li>
<li><a href="https://www.mysql.com/">mysql</a> c library, version 5.5 or higher<ul>
<li>a working version of mysql is available at <a href="http://downloads.mysql.com/archives/get/file/mysql-connector-c-6.1.5-src.tar.gz">http://downloads.mysql.com/archives/get/file/mysql-connector-c-6.1.5-src.tar.gz</a></li>
</ul>
</li>
</ul>
<p>If the above libraries are not in the system library paths, then you can specify their paths at configuration time: </p><pre class="fragment">$ ./configure CPPFLAGS='-I/path_to_libs/include' LDFLAGS='-L/path_to_libs/lib'
</pre><h1><a class="anchor" id="usage"></a>
bgpreader tool usage               </h1>
<p>bgp reader is a command line tool that prints to standard output information about a bgp stream. </p><pre class="fragment">usage: bgpreader -d &lt;interface&gt; [&lt;options&gt;]

    -d &lt;interface&gt;    use the given data interface to find available data
                                available data interfaces are:
        singlefile     Read a single mrt data file (a RIB and/or an update)
        csvfile        Retrieve metadata information from a csv file
        sqlite         Retrieve metadata information from a sqlite database
        mysql          Retrieve metadata information from the bgparchive mysql database

    -o &lt;option-name,option-value&gt;*    set an option for the current data interface.
                                                              use '-o ?' to get a list of available
                                                              options for the current data interface.
                                                              (data interface must be selected using -d)
    -P &lt;project&gt;   process records from only the given project (routeviews, ris)*
    -C &lt;collector&gt; process records from only the given collector*
    -T &lt;type&gt;      process records with only the given type (ribs, updates)*
    -W &lt;start,end&gt; process records only within the given time window*
    -R &lt;period&gt;    process a rib files every &lt;period&gt; seconds (bgp time)
    -b             make blocking requests for BGP records
                    allows bgpstream to be used to process data in real-time
    -r             print info for each BGP record (in bgpstream format) [default]
    -m             print info for each BGP valid record (in bgpdump -m format)
    -e             print info for each element of a valid BGP record
    -h             print this help menu
    * denotes an option that can be given multiple times

     Data interface options for 'singlefile':
              rib-file       rib mrt file to read (default: not-set)
              upd-file       updates mrt file to read (default: not-set)

     Data interface options for 'csvfile':
              csv-file       csv file listing the mrt data to read (default: not-set)

     Data interface options for 'sqlite':
              db-file        sqlite database (default: not-set)

     Data interface options for 'mysql':
              db-name        name of the mysql database to use (default: bgparchive)
              db-user        mysql username to use (default: bgpstream)
              db-password    mysql password to use (default: not-set)
              db-host        hostname/IP of the mysql server (default: not-set)
              db-port        port of the mysql server (default: not-set)
              db-socket      Unix socket of the mysql server (default: not-set)
              ris-path       Prefix path of RIS data (default: not-set)
              rv-path        prefix path of RouteViews data (default: not-set)
</pre><p>Example:</p>
<p>print out all the bgp elems observed in the <em>routeviews.route-views.jinx.updates.1427846400.bz2</em> file from 00:00:15 to 00:01:30</p>
<pre class="fragment">$ bgpreader -dsinglefile -oupd-file,./test/routeviews.route-views.jinx.updates.1427846400.bz2 -W1427846415,1427846490 -e

1427846430|196.223.14.55|30844|W|185.75.149.0/24|||||
1427846430|196.223.14.55|30844|W|103.47.62.0/23|||||
1427846430|196.223.14.55|30844|W|132.8.48.0/20|||||
1427846430|196.223.14.55|30844|W|132.8.64.0/18|||||
1427846430|196.223.14.55|30844|W|132.22.0.0/16|||||
1427846430|196.223.14.55|30844|W|131.34.0.0/16|||||
1427846430|196.223.14.55|30844|W|129.54.0.0/16|||||
1427846430|196.223.14.55|30844|A|41.159.135.0/24|196.223.14.55|30844 6939 12956 6713 16058|16058||
1427846430|196.223.14.55|30844|A|84.205.73.0/24|196.223.14.55|30844 6939 12654|12654||
</pre><h1><a class="anchor" id="tutorial"></a>
bgpstream C library tutorial               </h1>
<p>Below is a simple example that shows how to use most of the C library API functions. The example is fully functioning and it can be run within the <em>test</em> folder included in the distribution. </p><pre class="fragment">$ cd bgpstream-1.0.0/test
$ gcc ./tutorial.c  -lbgpstream -o ./tutorial
$ ./tutorial
 Read 1544 elems
</pre><p>The program reads information from the example sqlite database provided with the distribution and it counts the elems that match the filters (collectors, record type, and time).</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/socket.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;arpa/inet.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdbool.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="bgpstream_8h.html">bgpstream.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main()</div>
<div class="line">{</div>
<div class="line">  <span class="comment">/* Allocate memory for a bgpstream instance */</span></div>
<div class="line">  <a class="code" href="structstruct__bgpstream__t.html">bgpstream_t</a> *bs = bs = <a class="code" href="bgpstream_8h.html#a23cc5fd936f0a7fc13fd8526e879851a">bgpstream_create</a>();</div>
<div class="line">  <span class="keywordflow">if</span>(!bs) {</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;ERROR: Could not create BGPStream instance\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Allocate memory for a re-usable bgprecord instance */</span></div>
<div class="line">  <a class="code" href="structstruct__bgpstream__record__t.html">bgpstream_record_t</a> *bs_record = <a class="code" href="bgpstream__record_8h.html#a346ab423e33c75c8fd739094caa75a3b">bgpstream_record_create</a>();</div>
<div class="line">  <span class="keywordflow">if</span>(bs_record == NULL)</div>
<div class="line">    {</div>
<div class="line">      fprintf(stderr, <span class="stringliteral">&quot;ERROR: Could not create BGPStream record\n&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Configure the sqlite interface */</span></div>
<div class="line">  <a class="code" href="bgpstream_8h.html#af9f5a7c92fcda4ce33cbf816458c5b9a">bgpstream_data_interface_id_t</a> datasource_id = <a class="code" href="bgpstream_8h.html#a067d165c5dd804a88c9f73ebd9bbb6c4">bgpstream_get_data_interface_id_by_name</a>(bs, <span class="stringliteral">&quot;sqlite&quot;</span>);</div>
<div class="line">  <a class="code" href="bgpstream_8h.html#a48e8a0a1a0b8627f65ee310525fe77ad">bgpstream_set_data_interface</a>(bs, datasource_id);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Configure the sqlite interface options */</span></div>
<div class="line">  <a class="code" href="structstruct__bgpstream__data__interface__option.html">bgpstream_data_interface_option_t</a> *option = </div>
<div class="line">    <a class="code" href="bgpstream_8h.html#a76478fea868363e2f682f466c1db3138">bgpstream_get_data_interface_option_by_name</a>(bs, datasource_id,</div>
<div class="line">                                                <span class="stringliteral">&quot;db-file&quot;</span>);</div>
<div class="line">  <a class="code" href="bgpstream_8h.html#a7c170eb798f1024b544498c50a10fe06">bgpstream_set_data_interface_option</a>(bs, option, <span class="stringliteral">&quot;./sqlite_test.db&quot;</span>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Select bgp data from RRC06 and route-views.jinx collectors only */</span></div>
<div class="line">  <a class="code" href="bgpstream_8h.html#ab184e0236ef7c48f8ae9459c63d20398">bgpstream_add_filter</a>(bs, <a class="code" href="bgpstream_8h.html#a9d7e43566d66777ac468d27b81305a0ea75a407504c7d5ca7a73028592ce440f3">BGPSTREAM_FILTER_TYPE_COLLECTOR</a>, <span class="stringliteral">&quot;rrc06&quot;</span>);</div>
<div class="line">  <a class="code" href="bgpstream_8h.html#ab184e0236ef7c48f8ae9459c63d20398">bgpstream_add_filter</a>(bs, <a class="code" href="bgpstream_8h.html#a9d7e43566d66777ac468d27b81305a0ea75a407504c7d5ca7a73028592ce440f3">BGPSTREAM_FILTER_TYPE_COLLECTOR</a>, <span class="stringliteral">&quot;route-views.jinx&quot;</span>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Process updates only */</span></div>
<div class="line">  <a class="code" href="bgpstream_8h.html#ab184e0236ef7c48f8ae9459c63d20398">bgpstream_add_filter</a>(bs, <a class="code" href="bgpstream_8h.html#a9d7e43566d66777ac468d27b81305a0ea6c450394edc3bb3cacc126647905b8b2">BGPSTREAM_FILTER_TYPE_RECORD_TYPE</a>, <span class="stringliteral">&quot;updates&quot;</span>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Select a time interval to process:</span></div>
<div class="line"><span class="comment">   * Wed, 01 Apr 2015 00:02:30 GMT -&gt; Wed, 01 Apr 2015 00:05:00 UTC */</span></div>
<div class="line">  <a class="code" href="bgpstream_8h.html#a9beac741a7685c996ad4b0fd2d33b794">bgpstream_add_interval_filter</a>(bs,1427846550,1427846700);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Start bgpstream */</span></div>
<div class="line">  <span class="keywordflow">if</span>(<a class="code" href="bgpstream_8h.html#ad5e4489c5dd07a902b1b54faaea7ab11">bgpstream_start</a>(bs) &lt; 0) {</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;ERROR: Could not init BGPStream\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> get_next_ret = 0;</div>
<div class="line">  <span class="keywordtype">int</span> elem_counter = 0;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* pointer to a bgpstream elem, memory is borrowed from bgpstream,</span></div>
<div class="line"><span class="comment">   * use the elem_copy function to own the memory */</span></div>
<div class="line">  <a class="code" href="structstruct__bgpstream__elem__t.html">bgpstream_elem_t</a> *bs_elem = NULL;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Read the stream of records */</span></div>
<div class="line">  <span class="keywordflow">do</span></div>
<div class="line">    {</div>
<div class="line">      <span class="comment">/* get next record */</span></div>
<div class="line">      get_next_ret = <a class="code" href="bgpstream_8h.html#aa48a25f6bb885d91c1421b475f4cf313">bgpstream_get_next_record</a>(bs, bs_record);</div>
<div class="line">      <span class="keywordflow">if</span>(get_next_ret &amp;&amp; bs_record-&gt;<a class="code" href="structstruct__bgpstream__record__t.html#ad5c462369ff98d609e3a45ac3dfecf2f">status</a> == <a class="code" href="bgpstream__record_8h.html#a6a1a5710308783dc7338ec7e66d0af49af207da7c507d0d458dfdb20b0ea7a282">BGPSTREAM_RECORD_STATUS_VALID_RECORD</a>)</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">while</span>((bs_elem = <a class="code" href="bgpstream__record_8h.html#acd808836aac15d87e53f67567d4b2284">bgpstream_record_get_next_elem</a> (bs_record)) != NULL)</div>
<div class="line">            {</div>
<div class="line">              elem_counter++;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">while</span>(get_next_ret &gt; 0);</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;\tRead %d elems\n&quot;</span>, elem_counter);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* de-allocate memory for the bgpstream */</span></div>
<div class="line">  <a class="code" href="bgpstream_8h.html#a7f2df6c59c3a4d3d2f4cf407644412fa">bgpstream_destroy</a>(bs);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* de-allocate memory for the bgpstream record */</span></div>
<div class="line">  <a class="code" href="bgpstream__record_8h.html#a3474d7cb61571d2a36153fc07693df1b">bgpstream_record_destroy</a>(bs_record);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="docs"></a>
Documentation       </h1>
<p>This online [BGP Stream API] is currently the best source of information about using BGP Stream, please take a look at the installed headers:</p>
<ul>
<li><b><a class="el" href="bgpstream_8h.html" title="Header file that exposes the public interface of bgpstream. ">bgpstream.h</a></b></li>
<li><b><a class="el" href="bgpstream__record_8h.html" title="Header file that exposes the public interface of a bgpstream record. ">bgpstream_record.h</a></b></li>
<li><b><a class="el" href="bgpstream__elem_8h.html" title="Header file that exposes the public interface of a bgpstream elem. ">bgpstream_elem.h</a></b> </li>
</ul>
</div></div><!-- contents -->
</div> <!-- row -->
